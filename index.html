<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chronicles of the Kethaneum</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4efe7;
    }

    #loading-indicator {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .loader {
      border: 5px solid #f3f3f3;
      border-top: 5px solid #E6A817;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 2s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>

  <!-- Modular CSS -->
  <link rel="stylesheet" href="styles/cssVariables.css">
  <link rel="stylesheet" href="styles/baseCSS.css">
  <link rel="stylesheet" href="styles/desktopCSS.css">
  <link rel="stylesheet" media="(max-width: 768px)" href="styles/mobileCSS.css">
</head>

<body>
  <!-- Loading Indicator -->
  <div id="loading-indicator">
    <div class="loader"></div>
  </div>

  <div id="game-container">
    <!-- Title Screen -->
    <div id="title-screen" class="screen active">
      <div class="title-layout">
        <div class="logo-container">
          <img id="logo-static" src="images/logo-static.png" alt="Kethaneum Logo">
          <img id="logo-glow" src="images/logo-glow.png" alt="Kethaneum Logo Glow Effect" class="pulsing">
        </div>
        <div class="title-content">
          <h1 id="game-title">Chronicles of the Kethaneum</h1>
          <h2 id="game-subtitle">Searching the Cosmic Catalog</h2>
          <div class="button-container">
            <button id="new-game-btn" class="large">New Game</button>
            <button id="continue-btn" class="secondary">Continue</button>
            <button id="options-btn" class="secondary disabled">Options</button>
            <button id="credits-btn" class="secondary disabled">Credits</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Backstory Screen -->
    <div id="backstory-screen" class="screen">
      <div class="story-container">
        <h2>The Kethaneum</h2>
        <div id="backstory-content">
          <p>The Kethaneum exists in the spaces between worlds—a vast library stretching across dimensions, accessible
            only to those deemed worthy by its mysterious custodians. Neither fully physical nor entirely ethereal, this
            repository houses knowledge from countless civilizations, epochs, and realities.</p>

          <p>For millennia, brilliant minds across the multiverse have sought entry to this hallowed space. Few succeed.
            The journey requires years of dedicated study and the completion of increasingly complex trials that test
            not just intellect, but character and perseverance. Those who prove themselves receive a Book of Passage—a
            living artifact that serves as both key and chronicle.</p>

          <p>Your Book of Passage now rests in your hands, its pages initially blank except for your name. Unlike
            ordinary books, it observes and records your journey, adding new chapters as you explore the Kethaneum's
            infinite collections. Every discovery, every challenge overcome, every insight gained—all become part of
            your unique narrative, preserved within its pages.</p>

          <p>As you step through the threshold that separates your realm from the Kethaneum, remember: you are now both
            reader and story, archivist and archive. The knowledge you help preserve will guide countless others who
            follow in your footsteps.</p>
        </div>
      </div>
      <button id="continue-to-book-btn">Enter to the Library</button> <!-- refactor this button to a more generic id later.-->
    </div>

    <!-- Book of Passage Screen -->
    <div id="book-of-passage-screen" class="screen">
      <div class="book-container">
        <div class="book-spine"></div>
        <div class="book-pages">
          <h2>Your Book of Passage</h2>
          <div id="book-of-passage-content">
            <p><em>The pages of your Book of Passage shimmer as new words appear, chronicling your arrival:</em></p>

            <p>"Today marks your first day as Assistant Archivist within the hallowed halls of the Kethaneum, the
              greatest repository of knowledge across all realms. After years of dedicated study, you've earned this
              honored position—a rare achievement celebrated by your teachers and peers alike.</p>

            <p>Your assignment is to catalog the newly arrived knowledge constructs, which appear to you as books
              containing words scattered and unordered. By finding and organizing these words, you strengthen the
              Kethaneum's indexing matrix, making this wisdom accessible to scholars throughout the multiverse. The
              Senior Archivists have noticed your particular talent for pattern recognition—a gift that will serve you
              well as you bring order to chaos, one word at a time."</p>

            <div id="progress-section-container" class="progress-section">
              <!-- I'm trying to make this section have an id for the tests but the tests can't find it. :( )-->
              <h3>Your Archives Progress:</h3>
              <p>Cataloging Completed: <span id="completed-puzzles-count">0</span></p>
              <p>Books Discovered: <span id="completed-books-count">0</span></p>

              <div id="books-progress-section">
                <!-- Book progress will be filled dynamically -->
              </div>
            </div>
          </div>
        </div>
      </div>
      <button id="start-cataloging-btn" class="accent">Begin Cataloging</button>
    </div>

    <!-- Library Screen (Genre Selection) - Hidden for now but kept for future -->
    <div id="library-screen" class="screen">
      <h2>The Library Archives</h2>
      
      <!-- We'll add the SVG background later -->

      <!-- Main navigation panel -->
      <div class="main-nav-panel">
        <button id="book-of-passage-nav-btn" class="nav-button">Book of Passage</button>
      </div>
    </div>

    <!-- Puzzle Screen (Word Search Game) -->
    <div id="puzzle-screen" class="screen">
      <h1 class="book-title" id="book-title">Knowledge Construct</h1>

      <div class="timer-container">
        <div class="timer-bar" id="timer-bar"></div>
      </div>

      <div class="game-area">
        <div class="story-container">
          <div class="story-content" id="story-excerpt">
            Knowledge excerpt will appear here.
          </div>
        </div>

        <div class="grid-container">
          <div class="grid" id="word-grid"></div>
        </div>

        <div class="words-container">
          <ul class="word-list" id="word-list"></ul>
        </div>
      </div>

      <div class="controls">
        <button id="pause-btn">Pause</button>
        <button id="return-book-of-passage-btn" class="secondary">Book of Passage</button>
      </div>
    </div>
  </div>

  <!-- Win Panel -->
  <div class="panel" id="win-panel">
    <h2>Cataloging Complete!</h2>
    <p>You've successfully organized all the words in this knowledge construct!</p>
    <button id="next-book-btn" class="accent">Catalog Another</button>
    <button id="return-to-book-of-passage-btn">Return to Book of Passage</button>
  </div>

  <!-- Lose Panel -->
  <div class="panel" id="lose-panel">
    <h2>Time's Up!</h2>
    <p>You weren't able to organize all the words in time.</p>
    <button id="try-again-btn">Try Again</button>
    <button id="different-book-btn" class="secondary">Try a Different Construct</button>
  </div>

  <!-- Pause Panel -->
  <div class="panel" id="pause-panel">
    <h2>Cataloging Paused</h2>
    <button id="resume-btn" class="accent">Resume</button>
    <button id="restart-btn">Restart</button>
    <button id="go-to-book-btn" class="secondary">Go to Book of Passage</button>
  </div>

  <!-- Instructions Panel -->
  <div class="panel" id="instructions-panel">
    <h2>Cataloging Instructions</h2>
    <ul style="text-align: left; margin-bottom: 20px;">
      <li>Find all the words listed on the right side</li>
      <li>Click and drag to select letters in a straight line</li>
      <li>Words can go horizontally, vertically, or diagonally</li>
      <li>Words can also be spelled backwards</li>
      <li>Words can intersect</li>
      <li>Find all words before time expires to complete cataloging</li>
    </ul>
    <button id="start-playing-btn" class="accent">Begin Cataloging</button>
  </div>

  <!-- Error Panel -->
  <div class="panel" id="error-panel">
    <h2>Archive Error</h2>
    <p>An error has occurred while accessing the Kethaneum's archives.</p>
    <button id="error-action-btn" class="accent">Return to Book of Passage</button>
  </div>

  <!-- Single script entry point using ES modules -->
  <script type="module" src="scripts/moduleBootstrap.js"></script>
  <script nomodule src="moduleBootstrap.js  "></script>

  <!-- Updated JavaScript for screen display management -->
  <script>
    // This script ensures the screens display properly on initial load
    // It should be added after the main game script to override any conflicting settings

    document.addEventListener('DOMContentLoaded', () => {
      // Remove .active from all screens…
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      // …then add it only to the title screen
      document.getElementById('title-screen').classList.add('active');
    });
  </script>
</body>

</html>